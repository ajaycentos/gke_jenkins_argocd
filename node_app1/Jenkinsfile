pipeline {
  agent {
        label 'agent-nodes'
    }
  stages 
  {
    stage('Docker Build') 
    {
      agent {
		label 'agent-nodes'
	    }
      steps {
            checkout scm
            script {
               def gitSha = sh(returnStdout: true, script: 'git rev-parse --short HEAD').trim()


                       if (gitSha == null || gitSha.isEmpty()) {
            gitSha = 'latest'
          }

            sh '''
              cd node_app1
              ls -l
              docker build -t ajay/sampleapp:${gitSha} .
               '''
	     }
            }
    }
  }
}
